{% extends "base.html" %}

{% block page_content %}
<div id="map" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;"></div>

<script>

var osmUrl = 'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',
        osmAttrib = '&copy; <a href="http://openstreetmap.org/copyright">OpenStreetMap</a>',
        osm = L.tileLayer(osmUrl, { maxZoom: 18, attribution: osmAttrib }),
        map = new L.Map('map', { center: new L.LatLng(54.391091, 18.600883), zoom: 11 }),
        drawnItems = L.featureGroup().addTo(map);
L.control.layers({
    'Mapa': osm.addTo(map),
    "Satelita": L.tileLayer('http://www.google.cn/maps/vt?lyrs=s@189&gl=cn&x={x}&y={y}&z={z}', {
        attribution: 'Google'
    })
}, { 'Zaznaczenia': drawnItems }, { position: 'topleft', collapsed: false }).addTo(map);

var drawControlFull = new L.Control.Draw({
    draw: {
        polyline: false,
        marker: false,
        circle: true,
        polygon: true,
        circlemarker: false,
        rectangle: true,
        polygon: {
            allowIntersection: false,
            showArea: true
    }},
    edit: {
        featureGroup: drawnItems
    }
});
var drawControlEditOnly = new L.Control.Draw({
    edit: {
        featureGroup: drawnItems
    },
    draw: false
});
map.addControl(drawControlFull);

map.on(L.Draw.Event.CREATED, function (e) {
    drawnItems.addLayer(e.layer);
    map.removeControl(drawControlFull);
    map.addControl(drawControlEditOnly);
});

map.on(L.Draw.Event.DELETED, function(e) {
    if (drawnItems.getLayers().length === 0){
        map.removeControl(drawControlEditOnly);
        map.addControl(drawControlFull);
    }
});









L.marker([54.391091, 18.600883]).addTo(map).bindPopup('Some lazy Coder cave').openPopup();

var popup = L.popup();

// function onMapClick(e) {
// popup
//     .setLatLng(e.latlng)
//     .setContent("Hm what's here... " + e.latlng.toString())
//     .openOn(map);
// }
// map.on('click', onMapClick);

</script>
{% endblock %}